
DELETE FROM CarnetMeteo;

DROP TABLE CarnetMeteo CASCADE ;

CREATE TABLE CarnetMeteo
(
  journee       TEXT,
  temp_min      TEXT,
  temp_max      TEXT,
  humid_min     TEXT,
  humid_max     TEXT,
  precip        TEXT,
  nature_precip TEXT
);


INSERT INTO CarnetMeteo VALUES
   -- Section of invalid data
('1000-23','-10','10','5','95','0','O'),	-- date: not a date
('1200-12-01','-10','10','5','95','0','O'),	-- date: invalid year
('16-06-2020','-10','10','5','95','0','O'),	-- date: wrong format
('2020/06/16','-10','10','5','95','0','O'),	-- date: wrong character for format
('123.23','-10','10','5','95','0','O'),	-- date: not a date
('1','-10','10','5','95','0','O'),	-- date: not a date
('text','-10','10','5','95','0','O'),	-- date: not a date
('','-10','10','5','95','0','O'),	-- date: empty
('2020-12-01','text','10','5','95','0','O'),	-- temp_min: not a number repr
('2020-12-02','2020-12-21','10','5','95','0','O'),	-- temp_min: not a number repr
('2020-12-03','-100','10','5','95','0','O'),	-- temp_min: temp out of range
('2020-12-04','100','10','5','95','0','O'),	-- temp_min: temp out of range
('2020-12-05','100.','10','5','95','0','O'),	-- temp_min: temp out of range
('2020-12-06','-100.','10','5','95','0','O'),	-- temp_min: temp out of range
('2020-12-07','+10','10','5','95','0','O'),	-- temp_min: ???
('2020-12-08','- 100','10','5','95','0','O'),	-- temp_min: ???
('2020-12-09','20+1','10','5','95','0','O'),	-- temp_min: not a number repr
('2020-12-10','20.14568','10','5','95','0','O'),	-- temp_min: invalid, only 2 decimals are accepted
('2020-12-11','50.01','10','5','95','0','O'),	-- temp_min: invalid, 50.00 is the maximum
('2020-12-12','','10','5','95','0','O'),	-- temp_min: empty
('2020-12-13','-10','text','5','95','0','O'),	-- temp_max: not a number repr
('2020-12-14','-10','2020-12-21','5','95','0','O'),	-- temp_max: not a number repr
('2020-12-15','-10','-100','5','95','0','O'),	-- temp_max: temp out of range
('2020-12-16','-10','100','5','95','0','O'),	-- temp_max: temp out of range
('2020-12-17','-10','100.','5','95','0','O'),	-- temp_max: temp out of range
('2020-12-18','-10','-100.','5','95','0','O'),	-- temp_max: temp out of range
('2020-12-19','-10','+10','5','95','0','O'),	-- temp_max: ???
('2020-12-20','-10','- 100','5','95','0','O'),	-- temp_max: ???
('2020-12-21','-10','20+1','5','95','0','O'),	-- temp_max: not a number repr
('2020-12-22','-10','20.14568','5','95','0','O'),	-- temp_max: invalid, only 2 decimals are accepted
('2020-12-23','-10','50.01','5','95','0','O'),	-- temp_max: invalid, 50.00 is the maximum
('2020-12-24','-10','','5','95','0','O'),	-- temp_max: empty
('2020-12-25','-10','10','20%','95','0','O'),	-- humid_min: ???
('2020-12-26','-10','10','-1','95','0','O'),	-- humid_min: value out of range
('2020-12-27','-10','10','101','95','0','O'),	-- humid_min: value out of range
('2020-12-28','-10','10','20.5','95','0','O'),	-- humid_min: ???
('2020-12-29','-10','10','text','95','0','O'),	-- humid_min: not a number repr
('2020-12-30','-10','10','20-1','95','0','O'),	-- humid_min: not a number repr
('2020-12-31','-10','10','2020-12-21','95','0','O'),	-- humid_min: not a number repr
('2020-11-01','-10','10','','95','0','O'),	-- humid_min: empty
('2020-11-02','-10','10','5','20%','0','O'),	-- humid_max: ???
('2020-11-03','-10','10','5','-1','0','O'),	-- humid_max: value out of range
('2020-11-04','-10','10','5','101','0','O'),	-- humid_max: value out of range
('2020-11-05','-10','10','5','20.5','0','O'),	-- humid_max: ???
('2020-11-06','-10','10','5','text','0','O'),	-- humid_max: not a number repr
('2020-11-07','-10','10','5','20-1','0','O'),	-- humid_max: not a number repr
('2020-11-08','-10','10','5','2020-12-21','0','O'),	-- humid_max: not a number repr
('2020-11-09','-10','10','5','','0','O'),	-- humid_max: empty
('2020-11-10','-10','10','5','95','1000','O'),	-- precip: value out of range
('2020-11-11','-10','10','5','95','text','O'),	-- precip: not a number repr
('2020-11-12','-10','10','5','95','20-1','O'),	-- precip: not a number repr
('2020-11-13','-10','10','5','95','100.1','O'),	        -- precip: ???
('2020-11-14','-10','10','5','95','-1','O'),	        -- precip: out of range
('2020-11-15','-10','10','5','95','5mm','O'),	        -- precip: ???
('2020-11-16','-10','10','5','95','2020-12-21','O'),	-- precip: not a number repr
('2020-11-17','-10','10','5','95','','O'),	            -- precip: empty
('2020-11-18','-10','10','5','95','0','text'),	        -- nature: invalid value
('2020-11-19','-10','10','5','95','0','n'),	            -- nature: ???
('2020-11-20','-10','10','5','95','0','1'),	            -- nature: invalid value
('2020-11-21','-10','10','5','95','0','78'),	        -- nature: Decimal ASCII value for N
('2020-11-22','-10','10','5','95','0','4E'),	        -- nature: Hex ASCII value for N
('2020-11-23','-10','10','5','95','0','2020-12-21'),	-- nature: not a number repr
('2020-11-24','-10','10','5','95','0',''),	            -- nature: empty

   -- Section of real data (almost all are valid)
   -- Obtained from https://qu√©bec.weatherstats.ca/download.html
   -- min temperature from 2021-06-17 and 2021-06-18 was modified to test query Y4
('2021-08-31','14.8','25.4','44','91','0','O'),
('2021-08-30','17.6','27.8','49','99','4.5','P'),
('2021-08-29','15.2','20','75','99','12.4','P'),
('2021-08-28','10.4','21.7','43','80','0','O'),
('2021-08-27','10.6','23','40','76','0','O'),
('2021-08-26','18','32.2','34','99','0','O'),
('2021-08-25','17','30.9','45','95','0','O'),
('2021-08-24','17.8','31.7','41','97','0','O'),
('2021-08-23','20.4','27.1','72','95','0.4','P'),
('2021-08-22','18.5','29.4','59','84','0','O'),
('2021-08-21','18.3','29.5','52','91','0','O'),
('2021-08-20','18','31.8','51','94','0','O'),
('2021-08-19','19.7','29.2','66','100','0','O'),
('2021-08-18','18.4','27','70','97','0','O'),
('2021-08-17','12','27.5','45','98','0','O'),
('2021-08-16','9','25.6','43','98','0','O'),
('2021-08-15','10.7','23.4','38','86','0','O'),
('2021-08-14','13.5','27.7','44','96','0.3','P'),
('2021-08-13','21.2','30.8','55','98','0','O'),
('2021-08-12','19.8','30.9','63','100','1.9','P'),
('2021-08-11','20.2','25.8','77','98','5.1','P'),
('2021-08-10','16.9','30.3','56','100','0','O'),
('2021-08-09','15.1','24.3','57','91','2.8','P'),
('2021-08-08','13.8','24.6','45','80','0','O'),
('2021-08-07','17.2','26.5','62','92','0.2','P'),
('2021-08-06','13.8','27.8','56','99','0','O'),
('2021-08-05','14.7','27.8','48','96','0','O'),
('2021-08-04','15.1','24.6','63','97','0','O'),
('2021-08-03','11.4','24.2','60','92','0','O'),
('2021-08-02','12.6','22.9','45','96','0','O'),
('2021-08-01','8.8','23.4','47','94','0','O'),
('2021-07-31','9.3','21.8','40','93','0','O'),
('2021-07-30','10.9','20.4','57','99','0','O'),
('2021-07-29','8.6','21.7','65','98','2.6','P'),
('2021-07-28','7.8','22.7','34','90','0','O'),
('2021-07-27','9.4','22.2','43','97','0','O'),
('2021-07-26','14.6','25.4','64','99','14.7','P'),
('2021-07-25','15.4','25.5','61','98','28','P'),
('2021-07-24','10.3','27','44','99','0','O'),
('2021-07-23','12.1','24','56','93','3.9','P'),
('2021-07-22','10.8','24.6','44','99','0','O'),
('2021-07-21','11.1','20.2','59','95','3','P'),
('2021-07-20','16.9','24.9','60','92','1.2','P'),
('2021-07-19','17.4','28.2','55','98','0','O'),
('2021-07-18','17.1','26.9','49','97','0','O'),
('2021-07-17','13.8','25.8','63','98','0','O'),
('2021-07-16','14.8','25.4','48','94','8.6','P'),
('2021-07-15','15.5','28.9','57','100','0.3','P'),
('2021-07-14','16.7','25.8','79','99','14.8','P'),
('2021-07-13','13.4','25.9','59','88','0','O'),
('2021-07-12','14.5','26.7','38','95','0','O'),
('2021-07-11','11.3','26.9','43','99','0','O'),
('2021-07-10','8.7','25.8','44','98','0','O'),
('2021-07-09','10.5','21.3','58','99','4.2','P'),
('2021-07-08','9.2','19.2','55','97','','O'),
('2021-07-07','10.5','22','39','81','','O'),
('2021-07-06','14.7','27.1','72','93','','O'),
('2021-07-05','7.7','25.5','43','99','','O'),
('2021-07-04','9.1','21.4','38','96','','O'),
('2021-07-03','8.7','20.9','46','93','','O'),
('2021-07-02','11.2','20.2','43','90','','O'),
('2021-07-01','13.3','19','80','99','','O'),
('2021-06-30','16.4','26.4','73','99','22.1','P'),
('2021-06-29','19.7','29.2','63','98','1.9','P'),
('2021-06-28','20.6','27.2','64','99','0.6','P'),
('2021-06-27','20.6','29.1','65','100','36.4','P'),
('2021-06-26','15.9','21','79','99','41.4','P'),
('2021-06-25','12.6','26.1','45','89','0','O'),
('2021-06-24','7.5','26.3','33','96','0','O'),
('2021-06-23','8.3','20','40','81','0','O'),
('2021-06-22','9.2','21.8','62','96','0','O'),
('2021-06-21','13.4','23.7','63','99','16.3','P'),
('2021-06-20','13.1','25.7','53','97','0','O'),
('2021-06-19','14.2','24.2','59','97','9.3','P'),
('2021-06-18','2.3','26.2','43','97','10.1','P'),   -- damaged sensor: temp_min not correct
('2021-06-17','1.1','24.1','31','81','0','O'),      -- damaged sensor: temp_min not correct
('2021-06-16','6.8','19','45','93','0.5','P'),
('2021-06-15','9.9','18.9','68','98','9.8','P'),
('2021-06-14','12.2','17.1','61','95','13.4','P'),
('2021-06-13','9.6','22.3','32','77','0','O'),
('2021-06-12','7.5','25.2','22','67','0','O'),
('2021-06-11','8','23.2','33','81','0','O'),
('2021-06-10','6.9','18.6','30','72','0','O'),
('2021-06-09','10.5','25.7','25','54','0','O'),
('2021-06-08','20.8','30.6','52','87','0','O'),
('2021-06-07','16.5','32.5','41','99','0','O'),
('2021-06-06','15.7','26.2','56','97','0','O'),
('2021-06-05','12.2','24.9','68','99','0.2','P'),
('2021-06-04','12.8','23.5','65','99','0','O'),
('2021-06-03','9.6','18.8','64','99','7.8','P'),
('2021-06-02','5.9','26.3','34','100','0','O'),
('2021-6-1','6','23.4','37','100','2.2','P')
;
